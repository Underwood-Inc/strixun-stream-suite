# Streamkit API Service - Cloudflare Worker Configuration
# Dedicated worker for Streamkit cloud storage (text cyclers, swaps, layouts, notes, scene activity)

name = "strixun-streamkit-api"
main = "dist/worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Environment variables (secrets set via wrangler secret put in GitHub Actions)
# DO NOT put actual secrets here - they are set by deploy-manager.yml:
#   JWT_SECRET                   # REQUIRED: JWT signing secret (must match OTP auth service)
#   ALLOWED_ORIGINS              # OPTIONAL: Comma-separated CORS origins
#   SERVICE_API_KEY              # OPTIONAL: Service API key for service-to-service auth
#   NETWORK_INTEGRITY_KEYPHRASE  # OPTIONAL: Network integrity verification keyphrase

# Default configuration (used by wrangler deploy without --env flag)
[vars]
ENVIRONMENT = "production"

# KV Namespace binding
[[kv_namespaces]]
binding = "STREAMKIT_KV"
id = "193c308cee734e1bb08bba03ae2d65b0"

# Routes are managed in Cloudflare Dashboard (streamkit-api.idling.app)

# Observability Configuration
[observability]
enabled = true
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true
